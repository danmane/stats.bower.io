// Generated by CoffeeScript 1.7.1
(function() {
  var module;

  module = angular.module('B.Table.Pkgs', []);

  module.directive("bTablePkgs", function(bDataSvc) {
    return {
      templateUrl: 'b-table-pkgs/b-table-pkgs.html',
      restrict: 'E',
      link: function(scope) {
        var reduceFunc;
        reduceFunc = function(period, currentOrPrior) {
          return function(a, b, i) {
            if ((currentOrPrior === 'current' ? i >= period : i < period)) {
              return a + b;
            } else {
              return a;
            }
          };
        };
        bDataSvc.fetchAllP.then(function(data) {
          data.data.packages.forEach(function(pkg) {
            pkg.installsSum = [];
            pkg.installsSum.push(pkg.installs.reduce(reduceFunc(7, 'prior'), 0), pkg.installs.reduce(reduceFunc(7, 'current'), 0));
          });
          scope.packages = data.data.packages;
        });
        scope.hideAngular = true;
        scope.toggleHideAngular = function() {
          scope.hideAngular = !scope.hideAngular;
        };
      }
    };
  });

}).call(this);

//# sourceMappingURL=b-table-pkgs.map
